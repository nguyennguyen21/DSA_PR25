@page
@model DSA_PR25.Pages.Admin.Questions.IndexModel
@{
    Layout = "_LayoutAdmin";
    ViewData["Title"] = "Quản lý câu hỏi điền khuyết";
}

<h2> Quản lý câu hỏi điền khuyết</h2>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<p>
    <a asp-page="/Admin/Questions/AddFillInBlankPage" class="btn btn-primary"> Thêm câu hỏi</a>
</p>

@if (Model.Questions.Any())
{
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Nội dung</th>
                    <th>Chương</th>
                    <th>Đáp án đúng</th>
                    <th>Sai số</th>
                    <th>Từ đồng nghĩa</th>
                    <th>Ngày tạo</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var q in Model.Questions)
                {
                    <tr>
                        <td>@Html.Raw(q.Content.Replace("______", "<u>______</u>"))</td>
                        <td>@q.ChapterName</td>
                        <td><code>@q.CorrectAnswer</code></td>
                        <td>@(q.Tolerance?.ToString("0.##") ?? "—")</td>
                        <td>
                            @if (!string.IsNullOrWhiteSpace(q.Synonyms))
                            {
                                <small class="text-muted">@q.Synonyms</small>
                            }
                            else
                            {
                                <span>—</span>
                            }
                        </td>
                        <td>@(q.CreatedAt?.ToString("dd/MM/yyyy HH:mm"))</td>
                        <td>
                            <a asp-page="/Admin/Questions/EditFillInBlankPage" asp-route-id="@q.Id" class="btn btn-sm btn-warning">Sửa</a>
                            <form method="post" asp-page-handler="Delete" style="display:inline;"
                                  onsubmit="return confirm('Bạn có chắc muốn xóa câu hỏi này?');">
                                <input type="hidden" name="id" value="@q.Id" />
                                <button type="submit" class="btn btn-sm btn-danger">Xóa</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="alert alert-info">
        Chưa có câu hỏi điền khuyết nào.
        <a asp-page="/Admin/Questions/AddFillInBlankPage">Thêm ngay?</a>
    </div>
}